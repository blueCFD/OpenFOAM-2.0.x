--- bin/foamLog
+++ bin/foamLog
@@ -46,7 +46,7 @@
 cat <<LABUSAGE
 $PROGNAME - extracts xy files from Foam logs.
 
-Usage: $PROGNAME [-n][-s] <log>
+Usage: $PROGNAME [-n][-s][-m] <log>
            extracts xy files from log
        $PROGNAME -l <log>
            lists but does not extract
@@ -90,6 +90,8 @@
 Option -s suppresses the default information and only prints the extracted
 variables.
 
+Option -m merges outputs for when solvers don't use Time iterations.
+
 LABHELP
 }
 
@@ -161,14 +163,20 @@
 
     for var in $dbQueries
     do
-        getQueries $1 "$var"
-        line=`egrep "$LINEQ" $2`
-        if [ "$line" ]; then
-            column=`echo "$line" | fgrep "$NUMQ"`
-            if [ "$column" ]; then
-                queries="$queries $var"
-            fi
-        fi
+        case $var in
+        Separator*) :
+          ;;
+        *)
+          getQueries $1 "$var"
+          line=`egrep "$LINEQ" $2`
+          if [ "$line" ]; then
+              column=`echo "$line" | fgrep "$NUMQ"`
+              if [ "$column" ]; then
+                  queries="$queries $var"
+              fi
+          fi
+          ;;
+        esac
     done
 
     for q in $queries
@@ -191,9 +206,10 @@
 # sort arguments
 TIMENAME='Time'
 VERBOSE='yes'
+MERGEITERS=''
 LISTONLY=''
 
-while getopts nslh flags
+while getopts nmslh flags
 do
     case $flags in
         n)  TIMENAME=""
@@ -203,6 +219,8 @@
             ;;
         s)  VERBOSE=""
             ;;
+        m)  MERGEITERS="yes"
+            ;;
         l)  LISTONLY='yes'
             ;;
 	    \?) printUsage
@@ -328,6 +346,19 @@
 
 #-- Generate code for iteration separator (increments 'Iteration')
 getQueries $DBFILE 'Separator'
+LINEQ1=$LINEQ
+getQueries $DBFILE 'Separator2'
+LINEQ2=$LINEQ
+getQueries $DBFILE 'Separator3'
+LINEQ3=$LINEQ
+LINEQ=$LINEQ1
+if [ -z "$MERGEITERS" -o -n "`doesSeparatorExist \"$LINEQ1\" $LOG`" ]; then
+  LINEQ=$LINEQ1
+elif [ -n "`doesSeparatorExist \"$LINEQ2\" $LOG`" ]; then
+  LINEQ=$LINEQ2
+elif [ -n "`doesSeparatorExist \"$LINEQ3\" $LOG`" ]; then
+  LINEQ=$LINEQ3
+fi
 cat <<LABSEP >> $AWKFILE
 #-- Iteration separator (increments 'Iteration')
 /$LINEQ/ {
@@ -367,9 +399,10 @@
     extract(\$0, "Solving for ", varNameVal)
 
     varName=varNameVal[1]
+    extract(\$0, "Initial residual = ", val)
+    if(val[1]==varNameVal[1]) next;
     file=varName "_" subIter[varName]++
     file="$CASEDIR/logs/" file 
-    extract(\$0, "Initial residual = ", val)
     print $TIMENAME "\t" val[1] > file
 
     varName=varNameVal[1] "FinalRes"
